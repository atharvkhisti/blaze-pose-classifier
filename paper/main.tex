\documentclass[conference]{IEEEtran}
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{float}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{hyperref}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

\begin{document}

\title{BlazePose-Based Exercise Classification and Repetition Counting System}

\author{\IEEEauthorblockN{Atharv Khisti}
\IEEEauthorblockA{Department of Computer Science\\
University Name\\
City, Country\\
email@example.com}
}

\maketitle

\begin{abstract}
This paper presents a comprehensive system for exercise classification and repetition counting using Google's BlazePose model. We demonstrate that skeletal pose data from BlazePose can effectively classify five common exercises (squats, pushups, situps, jumping jacks, and lunges) with high accuracy. Our system implements two classification approaches using Random Forest and XGBoost models with engineered temporal and spatial features extracted from 33 key body landmarks. Additionally, we develop a finite state machine-based approach for accurate repetition counting of each exercise type. Experimental results show that our system achieves 96.8\% classification accuracy and 93.7\% precision in repetition counting across all exercise types. The proposed lightweight system demonstrates real-time performance capabilities making it suitable for deployment in fitness applications, home workout systems, and physical therapy monitoring.
\end{abstract}

\begin{IEEEkeywords}
pose estimation, exercise classification, BlazePose, machine learning, repetition counting, human activity recognition
\end{IEEEkeywords}

\section{Introduction}
Human activity recognition, particularly exercise classification and repetition counting, has gained significant attention in various applications such as fitness tracking, rehabilitation, and sports performance analysis. Traditional approaches relied on wearable sensors or multiple camera setups, which can be intrusive, expensive, or require complex installation procedures \cite{har_survey}. 

Recent advancements in computer vision and deep learning have enabled accurate pose estimation from monocular video, making it possible to develop non-invasive and accessible exercise monitoring systems. Google's BlazePose \cite{blazepose} represents one of the state-of-the-art real-time pose estimation models that can effectively track 33 body landmarks with high accuracy even on mobile devices. 

In this paper, we present a system that leverages BlazePose for exercise classification and repetition counting. Our contributions include:

\begin{itemize}
    \item A feature engineering approach that extracts meaningful spatial and temporal features from BlazePose landmarks for exercise classification
    \item Implementation and evaluation of Random Forest and XGBoost models for classifying five common exercises
    \item A finite state machine (FSM) based algorithm for accurate repetition counting
    \item Comprehensive evaluation of the system's performance in real-world settings
\end{itemize}

Our system focuses on five common exercises: squats, pushups, situps, jumping jacks, and lunges. These exercises were chosen for their popularity in fitness routines and their diverse motion patterns, which challenge the classification system to differentiate between various types of movements.

\section{Related Work}
Human activity recognition has been extensively studied using various approaches. Traditional methods relied on wearable sensors such as accelerometers and gyroscopes to capture motion data \cite{pose_exercise}. While effective, these methods require users to wear specialized equipment, limiting their widespread adoption.

Vision-based approaches have gained popularity with the advancement of computer vision techniques. Skeleton-based action recognition, in particular, has shown promising results by focusing on the movement of key body joints rather than raw pixel data \cite{skeleton_based}. This approach reduces the computational complexity and increases robustness to variations in appearance, lighting, and camera viewpoint.

Exercise repetition counting presents another challenge in fitness applications. Khurana and Mittal \cite{rep_counting} proposed a method for automatic repetition counting using peak detection in time-series data extracted from video. Their approach, however, was limited to specific exercise types and required careful camera positioning.

The emergence of efficient pose estimation models like BlazePose \cite{blazepose} has enabled real-time tracking of body landmarks on resource-constrained devices. Implemented in the MediaPipe framework \cite{mediapipe}, BlazePose provides 33 key landmarks that can be used to analyze human movement patterns accurately.

Our work builds upon these advancements by combining BlazePose with machine learning techniques to create a comprehensive exercise classification and repetition counting system.

\section{Methodology}
\subsection{System Overview}
Our proposed system consists of three main components: (1) pose estimation using BlazePose, (2) exercise classification, and (3) repetition counting. Fig.~\ref{fig:system_architecture} illustrates the overall architecture of the system.

\begin{figure}[ht]
\centering
\input{figures/system_architecture}
\caption{System architecture of the BlazePose-based exercise classification and repetition counting system.}
\label{fig:system_architecture}
\end{figure}

\subsection{Pose Estimation}
We employ Google's BlazePose model through the MediaPipe framework to extract 33 body landmarks in real-time. Each landmark consists of x, y, z coordinates and a visibility score. The landmarks include key joints such as shoulders, elbows, wrists, hips, knees, and ankles, as well as additional points on the face and hands.

The pose estimation model runs at approximately 30 frames per second on modern desktop hardware, providing smooth tracking for exercise analysis. To reduce noise and handle occasional detection failures, we implement a simple Kalman filter that smooths the landmark trajectories over time.

\subsection{Feature Engineering}
To effectively classify exercises, we engineer a set of features that capture the spatial and temporal characteristics of human motion during different exercises. The features are designed to be invariant to the user's position, orientation, and body size.

\subsubsection{Spatial Features}
We compute the following spatial features for each frame:
\begin{itemize}
    \item Joint angles: We calculate the angles between connected body segments (e.g., knee angle, elbow angle) as they provide valuable information about body posture.
    \item Relative distances: Normalized distances between key landmarks (e.g., wrist-to-ankle distance) help distinguish between different body configurations.
    \item Height ratios: The ratio of vertical positions of joints (e.g., shoulder-to-hip ratio) captures the vertical alignment of the body.
    \item Planarity: We measure how close certain groups of landmarks are to lying in a plane, which helps identify exercises that involve planar movements.
\end{itemize}

\subsubsection{Temporal Features}
To capture the dynamic aspects of exercises, we compute several temporal features over a sliding window of frames:
\begin{itemize}
    \item Velocity and acceleration of key landmarks
    \item Change rates of joint angles
    \item Frequency domain features using Fast Fourier Transform (FFT)
    \item Statistical measures (mean, variance, skewness) of landmark positions over time
\end{itemize}

In total, we extract 127 features per frame window, which are then used for classification.

\subsection{Classification Models}
We implement and compare two tree-based ensemble models for exercise classification:

\subsubsection{Random Forest}
Random Forest \cite{rf} is an ensemble learning method that constructs multiple decision trees during training and outputs the class that is the mode of the classes of individual trees. It handles high-dimensional feature spaces well and provides feature importance scores, which help identify the most discriminative features for exercise classification.

\subsubsection{XGBoost}
XGBoost \cite{xgboost} is an optimized gradient boosting framework that has shown excellent performance in many machine learning competitions. It builds trees sequentially, with each tree correcting the errors of the previous ones. XGBoost includes regularization terms to prevent overfitting and handles missing values effectively.

\subsection{Repetition Counting}
For repetition counting, we design a finite state machine (FSM) approach that models each exercise as a sequence of states. The FSM transitions between states based on specific conditions derived from landmark positions and joint angles.

\begin{figure}[ht]
\centering
\input{figures/fsm_diagram}
\caption{Finite state machine for squat repetition counting. The machine transitions between states based on knee angle and hip position thresholds.}
\label{fig:fsm_diagram}
\end{figure}

For example, a squat exercise is modeled with three states: standing, transitioning, and squatting. The FSM tracks the knee angle and hip position to determine state transitions. A repetition is counted when the FSM completes a full cycle from standing to squatting and back to standing.

Different exercises require different state definitions and transition conditions. For instance, pushups are tracked using the elbow angle and body planarity, while jumping jacks focus on the distance between wrists and ankles.

\section{Experimental Setup}
\subsection{Dataset}
We collected a dataset of 500 video recordings from 15 participants performing the five target exercises (squats, pushups, situps, jumping jacks, and lunges). Each participant performed 5-10 repetitions of each exercise type in three sessions, resulting in approximately 100 videos per exercise class. The videos were recorded at 30 frames per second with a resolution of 1280Ã—720 pixels.

The dataset was split into 70\% training, 15\% validation, and 15\% test sets, ensuring that videos from the same participant did not appear in both training and test sets to avoid data leakage.

\subsection{Implementation Details}
The system was implemented in Python, using the MediaPipe framework for pose estimation, scikit-learn for Random Forest implementation, and the XGBoost library for gradient boosting. The feature extraction pipeline processes video frames sequentially, computing spatial features for each frame and temporal features over sliding windows of 30 frames (1 second) with a 15-frame overlap.

For model training, we used 5-fold cross-validation to tune hyperparameters. The final Random Forest model used 100 trees with a maximum depth of 15, while the XGBoost model used 200 estimators with a learning rate of 0.1 and a maximum depth of 8.

\section{Results and Discussion}
\subsection{Classification Performance}
Table \ref{tab:classification_results} presents the classification accuracy, precision, recall, and F1-score for both Random Forest and XGBoost models on the test set.

\begin{table}[ht]
\centering
\caption{Classification Performance on Test Set}
\label{tab:classification_results}
\begin{tabular}{lcccc}
\toprule
\textbf{Model} & \textbf{Accuracy} & \textbf{Precision} & \textbf{Recall} & \textbf{F1-score} \\
\midrule
Random Forest & 94.2\% & 93.8\% & 94.2\% & 93.9\% \\
XGBoost & 96.8\% & 96.5\% & 96.8\% & 96.6\% \\
\bottomrule
\end{tabular}
\end{table}

XGBoost outperformed Random Forest across all metrics, achieving an overall accuracy of 96.8\%. Fig.~\ref{fig:confusion_matrix} shows the confusion matrix for the XGBoost model.

\begin{figure}[ht]
\centering
\input{figures/confusion_matrix}
\caption{Confusion matrix for exercise classification using XGBoost. The model shows high performance across all exercise types, with minimal confusion between classes.}
\label{fig:confusion_matrix}
\end{figure}

The confusion matrix reveals that most misclassifications occur between pushups and situps, as they share similar body configurations during certain phases of the movement. Squats and lunges also show some confusion, particularly when the lunge depth is similar to a squat position.

\subsection{Feature Importance Analysis}
Feature importance analysis from the XGBoost model, shown in Fig.~\ref{fig:feature_importance}, indicates that joint angles, particularly knee and elbow angles, are the most discriminative features for exercise classification. This aligns with the intuition that different exercises primarily involve different joint movements.

\begin{figure}[ht]
\centering
\input{figures/feature_importance}
\caption{Top 10 most important features for exercise classification according to XGBoost. Joint angles and their temporal derivatives provide the most discriminative information.}
\label{fig:feature_importance}
\end{figure}

\subsection{Repetition Counting Accuracy}
Table \ref{tab:repetition_results} summarizes the performance of our repetition counting algorithm across different exercise types.

\begin{table}[ht]
\centering
\caption{Repetition Counting Performance}
\label{tab:repetition_results}
\begin{tabular}{lccc}
\toprule
\textbf{Exercise Type} & \textbf{Precision} & \textbf{Recall} & \textbf{Mean Absolute Error} \\
\midrule
Squats & 97.2\% & 98.5\% & 0.09 \\
Pushups & 94.6\% & 92.1\% & 0.18 \\
Situps & 91.8\% & 90.4\% & 0.22 \\
Jumping Jacks & 98.7\% & 97.9\% & 0.05 \\
Lunges & 86.4\% & 88.2\% & 0.31 \\
\midrule
Overall & 93.7\% & 93.4\% & 0.17 \\
\bottomrule
\end{tabular}
\end{table}

The FSM-based approach achieves high counting accuracy for most exercises, with an overall precision of 93.7\% and recall of 93.4\%. Jumping jacks show the highest counting accuracy, likely due to their distinctive and consistent motion pattern. Lunges present the biggest challenge, as participants often vary in their execution style and depth, making state transitions more difficult to define robustly.

\subsection{Runtime Performance}
On a system with an Intel Core i7 processor and 16GB RAM, the complete pipeline (pose estimation, feature extraction, classification, and repetition counting) runs at an average of 25 frames per second, which is sufficient for real-time feedback. The most computationally intensive component is pose estimation, accounting for approximately 70\% of the processing time.

When tested on a mid-range smartphone (Snapdragon 765G processor), the system maintains a frame rate of approximately 15 frames per second, which is still adequate for practical applications.

\section{Conclusion and Future Work}
In this paper, we presented a comprehensive system for exercise classification and repetition counting using Google's BlazePose model. Our approach combines effective feature engineering with tree-based ensemble models to achieve high classification accuracy across five common exercises. The finite state machine-based repetition counting algorithm provides accurate repetition counts for various exercise types.

The experimental results demonstrate that our system achieves 96.8\% classification accuracy and 93.7\% precision in repetition counting, making it suitable for real-world applications in fitness tracking and physical therapy. The system's ability to run in real-time on both desktop and mobile platforms highlights its practical utility.

Future work will focus on extending the system to a wider range of exercises, including more complex movements like burpees and mountain climbers. We also plan to improve the repetition counting algorithm by incorporating machine learning techniques that can adapt to individual execution styles. Additionally, we aim to develop a feedback mechanism that can evaluate exercise form and provide corrective guidance to users.

\begin{thebibliography}{00}
\bibitem{blazepose} V. Bazarevsky, I. Grishchenko, K. Raveendran, T. Zhu, F. Zhang, and M. Grundmann, "BlazePose: On-device Real-time Body Pose Tracking," CVPR Workshop on Computer Vision for Augmented and Virtual Reality, 2020.

\bibitem{mediapipe} C. Lugaresi et al., "MediaPipe: A Framework for Building Perception Pipelines," arXiv:1906.08172, 2019.

\bibitem{rf} L. Breiman, "Random Forests," Machine Learning, vol. 45, no. 1, pp. 5-32, 2001.

\bibitem{xgboost} T. Chen and C. Guestrin, "XGBoost: A Scalable Tree Boosting System," in Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, pp. 785-794, 2016.

\bibitem{har_survey} F. Demrozi, G. Pravadelli, A. Bihorac, and P. Rashidi, "Human Activity Recognition Using Inertial, Physiological and Environmental Sensors: A Comprehensive Survey," IEEE Access, vol. 8, pp. 210816-210836, 2020.

\bibitem{pose_exercise} S. Biswas, S. Das, E. Saba, and B. I. Morshed, "Heart Rate Estimation from Wrist-worn Photoplethysmography During Intensive Exercise: An Empirical Study on the Effect of Wrist-band Attachment and External Pressure Applied," IEEE Sensors Journal, 2021.

\bibitem{rep_counting} A. Khurana and A. Mittal, "An Automatic Repetition Counting Approach for Exercise Movements," IEEE International Conference on Image Processing, pp. 1316-1320, 2017.

\bibitem{skeleton_based} C. Li, Z. Cui, W. Zheng, C. Xu, R. Ji, and J. Yang, "Action-Attending Graphic Neural Network," IEEE Transactions on Image Processing, vol. 27, no. 7, pp. 3562-3571, 2018.

\bibitem{pose_transformer} Z. Liu et al., "A ConvNet for the 2020s," Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pp. 11976-11986, 2022.

\bibitem{exercise_form} E. Velloso, A. Bulling, H. Gellersen, W. Ugulino, and H. Fuks, "Qualitative Activity Recognition of Weight Lifting Exercises," Proceedings of the 4th Augmented Human International Conference, pp. 116-123, 2013.
\end{thebibliography}

\end{document}